machine:
  post:
    - pyenv global 2.7.12 3.6.2

dependencies:
  pre:
    - sudo apt update; sudo apt install ruby-sass
  override:
    - npm install uglify-js -g

compile:
    override:
      - mkdir css
      - sass --update resources/www/scss:www/css
      - python3.6 build/compile/minify.py

test:
  override:
    - python2.7 ./build/tests/filenames.py www
    - python2.7 ./build/tests/existence.py www
    - sh ./build/tests/line-endings.sh

deployment:
  testing:
    branch: master
    commands:
      - scp -r www/* mentor@compcamps.com:/home/mentor/public_html/testing

  production:
    tag: /release-.*/
    commands:
      - scp -r www/* mentor@compcamps.com:/home/mentor/public_html/
